<!DOCTYPE html>
<html lang="en">
<head>
  <!-- 
    ===========================================================
    Title & Meta
    -----------------------------------------------------------
    This is an extremely robust and verbose example of an 
    S Corp vs. Sole Prop Tax Calculator webpage. 
    The user requested a big code, so let's have fun 
    and show off just how thorough we can be.
    ===========================================================
  -->
  <meta charset="UTF-8" />
  <title>CPA On Fire - Ultimate S Corp vs. Sole Prop Calculator</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <!-- 
    Linking optional Google Fonts. 
    We might use more than we actually need, purely for demonstration. 
  -->
  <link
    rel="stylesheet"
    href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;600;700&family=Roboto+Mono:wght@400;700&display=swap"
  />

  <!-- 
    ===========================================================
    Inline CSS 
    -----------------------------------------------------------
    For demonstration, we are packing a large set of styles 
    in here to ensure we have a big code base. 
    Typically, you'd move all this to a separate styles.css file.
    ===========================================================
  -->
  <style>
    /* 
      +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
      GLOBAL RESETS & BASE STYLES
      +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
      We start with a typical "reset" or "normalize" approach, 
      then define base fonts, colors, etc.
    */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    html, body {
      width: 100%;
      height: 100%;
      font-family: 'Open Sans', sans-serif;
      background-color: #fafafa;
      color: #333;
      line-height: 1.5;
    }
    a {
      text-decoration: none;
      color: inherit;
    }
    ul, li {
      list-style: none;
    }
    img {
      max-width: 100%;
      height: auto;
      display: block;
    }
    /* 
      We'll define a few color variables using CSS custom properties 
      so we can easily reference them throughout. 
      The user brand color is #DE3922 from earlier instructions 
      (CPA On Fire red).
    */
    :root {
      --brand-red: #DE3922;
      --brand-black: #000000;
      --brand-gray-light: #f9f9f9;
      --brand-gray: #666666;
      --brand-white: #ffffff;
      --brand-bg: #fafafa;
      --brand-container-width: 1200px;
    }

    /* 
      Global container utility 
      for aligning content consistently 
    */
    .container {
      width: 100%;
      max-width: var(--brand-container-width);
      margin: 0 auto;
      padding: 0 1rem;
    }

    /* 
      +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
      NAVBAR
      +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
    */
    .navbar {
      background-color: var(--brand-red);
      padding: 1rem 0;
    }
    .navbar .nav-wrapper {
      display: flex;
      align-items: center;
      justify-content: space-between;
    }
    .navbar .logo {
      font-size: 1.5rem;
      font-weight: 700;
      color: var(--brand-white);
    }
    .navbar .nav-menu {
      display: flex;
      gap: 1.5rem;
    }
    .navbar .nav-menu li a {
      color: var(--brand-white);
      font-weight: 600;
      transition: color 0.3s;
    }
    .navbar .nav-menu li a:hover {
      color: var(--brand-black);
    }

    /* 
      +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
      HERO SECTION
      +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
    */
    .hero {
      background-color: var(--brand-white);
      text-align: center;
      padding: 3rem 1rem;
      border-bottom: 1px solid #e0e0e0;
      position: relative;
      /* 
        We'll optionally add a subtle background pattern or image, 
        just to demonstrate an advanced approach. 
      */
      background-image: linear-gradient(
        120deg, 
        rgba(222,57,34,0.1) 0%, 
        rgba(222,57,34,0.02) 100%
      );
    }
    .hero h1 {
      font-size: 2rem;
      color: var(--brand-red);
      margin-bottom: 1rem;
      font-weight: 700;
    }
    .hero p {
      font-size: 1.1rem;
      color: var(--brand-gray);
      margin-bottom: 2rem;
      max-width: 700px;
      margin-left: auto;
      margin-right: auto;
    }
    .hero-btn {
      display: inline-block;
      padding: 0.75rem 1.5rem;
      background-color: var(--brand-red);
      color: var(--brand-white);
      font-weight: 600;
      border-radius: 4px;
      transition: background-color 0.3s;
    }
    .hero-btn:hover {
      background-color: #a42616; /* darker red upon hover */
    }

    /* 
      +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
      ABOUT / INTRO SECTION
      +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
      We introduce extra sections to expand the code. 
    */
    .about-section {
      background-color: var(--brand-gray-light);
      padding: 3rem 1rem;
    }
    .about-section .about-container {
      text-align: center;
      max-width: 900px;
      margin: 0 auto;
    }
    .about-section h2 {
      color: var(--brand-red);
      font-size: 1.75rem;
      font-weight: 700;
      margin-bottom: 1rem;
    }
    .about-section p {
      margin-bottom: 1rem;
      color: var(--brand-gray);
    }
    .about-section .about-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 2rem;
      margin-top: 2rem;
    }
    .about-section .about-card {
      background-color: var(--brand-white);
      padding: 1.5rem;
      border-radius: 6px;
      box-shadow: 0 1px 4px rgba(0,0,0,0.1);
      text-align: left;
    }
    .about-card h3 {
      color: var(--brand-red);
      margin-bottom: 0.75rem;
      font-weight: 600;
      font-size: 1.2rem;
    }
    .about-card p {
      color: #555;
      margin-bottom: 0.5rem;
    }

    /* 
      +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
      CALCULATOR SECTION
      +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
      We'll break it into multiple steps, and add more advanced 
      toggles, disclaimers, etc. 
    */
    .calculator-section {
      background-color: var(--brand-white);
      padding: 3rem 1rem;
    }
    .calc-container {
      max-width: 900px;
      margin: 0 auto;
    }
    .calc-header {
      text-align: center;
      margin-bottom: 2rem;
    }
    .calc-header h2 {
      color: var(--brand-red);
      font-size: 1.5rem;
      font-weight: 700;
      margin-bottom: 0.75rem;
    }
    .calc-header p {
      color: var(--brand-gray);
      max-width: 700px;
      margin: 0 auto;
    }

    .calc-step {
      margin-bottom: 2rem;
    }
    .calc-step h3 {
      font-size: 1.2rem;
      color: var(--brand-red);
      font-weight: 600;
      margin-bottom: 0.5rem;
    }
    .calc-step p {
      color: #555;
      margin-bottom: 1rem;
    }
    .slider-group, .form-group {
      margin-bottom: 1.5rem;
    }
    .slider-label {
      font-weight: 700;
      color: #333;
      display: block;
      margin-bottom: 0.5rem;
    }
    .slider-value {
      margin-left: 0.75rem;
      color: var(--brand-red);
      font-weight: 700;
    }
    .range-input {
      width: 100%;
      margin-top: 0.5rem;
    }
    .form-group input[type="number"] {
      width: 100%;
      padding: 0.5rem;
      border-radius: 4px;
      border: 1px solid #ccc;
    }

    /* 
      We'll create an advanced toggle section 
      so we can display additional disclaimers or advanced user input 
      (like Additional Medicare Tax or filing status). 
    */
    .advanced-toggle {
      margin-bottom: 2rem;
    }
    .toggle-label {
      display: inline-block;
      margin-right: 1rem;
      font-weight: 600;
      color: #333;
    }
    .toggle-label input {
      margin-right: 0.5rem;
      vertical-align: middle;
    }
    .advanced-section {
      display: none; /* hidden by default, revealed if user checks advanced */
      background-color: #f9f9f9;
      padding: 1rem;
      border-radius: 4px;
      margin-top: 1rem;
      border: 1px solid #e0e0e0;
    }
    .advanced-section h4 {
      color: var(--brand-red);
      margin-bottom: 0.5rem;
    }
    .advanced-section p {
      color: #555;
      margin-bottom: 0.75rem;
    }
    .filing-group {
      margin-bottom: 1rem;
    }
    .filing-group label {
      display: block;
      font-weight: 600;
      margin-bottom: 0.25rem;
    }
    .filing-group select {
      width: 100%;
      padding: 0.4rem;
      border-radius: 4px;
      border: 1px solid #ccc;
    }

    /* 
      Calculation Button 
    */
    .calc-btn {
      display: inline-block;
      padding: 0.75rem 1.5rem;
      background-color: var(--brand-red);
      color: var(--brand-white);
      font-weight: 600;
      border-radius: 4px;
      transition: background-color 0.3s;
      border: none;
      cursor: pointer;
    }
    .calc-btn:hover {
      background-color: #a42616;
    }

    /* 
      +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
      RESULTS SECTION
      +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
      We'll create a big table, disclaimers, and breakdown. 
    */
    .results-section {
      margin-top: 3rem;
      display: none; /* hide until user calculates */
    }
    .results-header {
      text-align: center;
      margin-bottom: 2rem;
    }
    .results-header h2 {
      color: var(--brand-red);
      font-weight: 700;
      font-size: 1.4rem;
      margin-bottom: 0.5rem;
    }
    .results-header p {
      color: #666;
    }
    .results-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 2rem;
      margin-bottom: 2rem;
    }
    .results-card {
      background-color: var(--brand-gray-light);
      padding: 1.5rem;
      border-radius: 6px;
      box-shadow: 0 1px 4px rgba(0,0,0,0.1);
    }
    .results-card h3 {
      color: var(--brand-red);
      font-size: 1.2rem;
      font-weight: 600;
      margin-bottom: 1rem;
    }
    .results-card .result-line {
      margin-bottom: 0.5rem;
      color: #555;
    }
    .results-card .result-bold {
      font-weight: 700;
      color: #333;
    }
    .results-difference {
      text-align: center;
      font-size: 1.25rem;
      color: var(--brand-red);
      font-weight: 700;
      margin-bottom: 2rem;
    }
    /* 
      We'll add an "extended breakdown" table to show each step 
      of the official SE tax or payroll tax if the user wants 
      a more line-by-line approach. 
    */
    .breakdown-toggle {
      text-align: center;
      margin-bottom: 1rem;
    }
    .breakdown-section {
      display: none;
      margin-top: 1rem;
    }
    .breakdown-table {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 2rem;
    }
    .breakdown-table thead {
      background-color: var(--brand-red);
      color: var(--brand-white);
    }
    .breakdown-table th,
    .breakdown-table td {
      padding: 0.75rem;
      border: 1px solid #ccc;
      text-align: left;
    }
    .breakdown-table th {
      font-weight: 700;
    }
    .breakdown-note {
      color: #777;
      font-size: 0.9rem;
      margin-bottom: 2rem;
    }

    /* 
      +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
      DISCLAIMER & CTA SECTION
      +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
    */
    .disclaimer-cta {
      background-color: var(--brand-gray-light);
      padding: 3rem 1rem;
      text-align: center;
      margin-top: 3rem;
    }
    .disclaimer-cta h3 {
      color: var(--brand-red);
      margin-bottom: 1rem;
      font-weight: 700;
    }
    .disclaimer-cta p {
      color: #555;
      max-width: 800px;
      margin: 0 auto 1rem;
    }
    .cta-btn {
      display: inline-block;
      padding: 0.75rem 1.5rem;
      background-color: var(--brand-red);
      color: #fff;
      font-weight: 600;
      border-radius: 4px;
      transition: background-color 0.3s;
      margin-top: 1rem;
      text-decoration: none;
    }
    .cta-btn:hover {
      background-color: #a42616;
    }

    /* 
      +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
      FOOTER
      +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
    */
    .footer {
      background-color: var(--brand-black);
      color: var(--brand-white);
      text-align: center;
      padding: 1rem 0;
      margin-top: 3rem;
    }

    /* 
      +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
      RESPONSIVE BREAKPOINTS
      +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
      We'll add multiple breakpoints to demonstrate more lines 
      and better responsive design. 
    */
    @media (max-width: 900px) {
      .results-grid {
        grid-template-columns: 1fr;
      }
      .about-section .about-grid {
        grid-template-columns: 1fr;
      }
    }
    @media (max-width: 600px) {
      .hero h1 {
        font-size: 1.5rem;
      }
      .hero p {
        font-size: 1rem;
      }
      .calc-header h2 {
        font-size: 1.3rem;
      }
      .navbar .nav-wrapper {
        flex-direction: column;
      }
      .navbar .nav-menu {
        margin-top: 1rem;
      }
    }
  </style>
</head>
<body>

  <!-- 
    +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
    NAVIGATION BAR
    +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
  -->
  <header class="navbar">
    <div class="container nav-wrapper">
      <div class="logo">CPA On Fire</div>
      <ul class="nav-menu">
        <li><a href="#hero">Home</a></li>
        <li><a href="#calculator">Calculator</a></li>
        <li><a href="#disclaimerCta">Contact</a></li>
      </ul>
    </div>
  </header>

  <!-- 
    +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
    HERO SECTION
    +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
  -->
  <section class="hero" id="hero">
    <div class="container">
      <h1>S Corp vs. Sole Proprietorship</h1>
      <p>
        Maximize your tax savings by comparing how much you’d pay as a Sole Proprietor 
        vs. an S Corporation. Adjust real-world inputs and see your potential tax difference 
        instantly. Explore advanced settings to incorporate Additional Medicare Tax, 
        wage base limits, or state-specific fees. 
      </p>
      <a class="hero-btn" href="#calculator">Get Started</a>
    </div>
  </section>

  <!-- 
    +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
    ABOUT SECTION
    +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
    We add an about section with cards to further inflate code size.
  -->
  <section class="about-section">
    <div class="container about-container">
      <h2>Why This Calculator Matters</h2>
      <p>
        At CPA On Fire, we believe in empowering business owners with the knowledge 
        and tools they need to make informed decisions. This calculator is designed 
        to give you a solid understanding of the approximate tax implications of 
        remaining a sole proprietor vs. electing S Corp status.
      </p>
      <p>
        Our tool factors in crucial details like the Social Security wage base, 
        Medicare contributions, potential state fees, and more. However, keep in mind that 
        your real-life situation may vary. Laws change, and not all states handle S Corps 
        the same way. We strongly recommend seeking professional guidance for a final decision.
      </p>

      <div class="about-grid">
        <div class="about-card">
          <h3>The Official SE Tax Method</h3>
          <p>
            We use the official 92.35% factor to determine Net Earnings from self-employment, 
            plus separate the Social Security portion (12.4%) from the Medicare portion (2.9%).
          </p>
          <p>
            This approach ensures we’re as close as possible to actual IRS forms like 
            Schedule SE. It can differ from simplified web calculators that multiply 
            total income by 15.3% or use other shortcuts.
          </p>
        </div>

        <div class="about-card">
          <h3>Business-Specific Nuances</h3>
          <p>
            Health insurance premiums, retirement plan contributions, 
            and other variables can affect your overall tax scenario. 
            Our advanced settings let you toggle Additional Medicare Tax 
            or specify filing status to see how it might shift your numbers.
          </p>
          <p>
            Ultimately, the best strategy is the one tailored to your unique situation. 
            That’s where personalized help from CPA On Fire can make all the difference.
          </p>
        </div>
      </div>
    </div>
  </section>

  <!-- 
    +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
    CALCULATOR SECTION
    +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
  -->
  <section class="calculator-section" id="calculator">
    <div class="container calc-container">
      <div class="calc-header">
        <h2>Multi-Step S Corp Tax Savings Calculator</h2>
        <p>
          Simply move the sliders, enter state info, and adjust advanced settings if needed. 
          We’ll compute an approximate difference in taxes between operating as a 
          Sole Proprietor and an S Corporation.
        </p>
      </div>

      <!-- Step 1: Net Income (before salary) -->
      <div class="calc-step">
        <h3>Step 1: Annual Net Income</h3>
        <p>
          Enter or slide your expected net business profit (before paying yourself a salary, 
          if you’re considering an S Corp).
        </p>
        <div class="slider-group">
          <label class="slider-label" for="netIncomeRange">Net Income (e.g. 100,000):</label>
          <input
            type="range"
            class="range-input"
            id="netIncomeRange"
            min="10000"
            max="500000"
            step="1000"
            value="100000"
            oninput="updateNetIncomeValue(this.value)"
          />
          <span class="slider-value" id="netIncomeValue">$100,000</span>
        </div>
      </div>

      <!-- Step 2: Owner Salary -->
      <div class="calc-step">
        <h3>Step 2: Reasonable Owner Salary</h3>
        <p>
          If you elect S Corp status, you must pay yourself a reasonable salary. 
          Slide to choose how much you’d draw as W-2 wages.
        </p>
        <div class="slider-group">
          <label class="slider-label" for="ownerSalaryRange">Owner Salary:</label>
          <input
            type="range"
            class="range-input"
            id="ownerSalaryRange"
            min="20000"
            max="200000"
            step="1000"
            value="60000"
            oninput="updateOwnerSalaryValue(this.value)"
          />
          <span class="slider-value" id="ownerSalaryValue">$60,000</span>
        </div>
      </div>

      <!-- Step 3: Additional S Corp Fees or Costs -->
      <div class="calc-step">
        <h3>Step 3: Additional S Corp Costs</h3>
        <p>
          Many states impose extra S Corp fees, plus you may have additional 
          accounting or payroll costs. Enter your best estimate below:
        </p>
        <div class="form-group">
          <label class="slider-label" for="extraFees">Annual S Corp Costs (e.g. 2,000):</label>
          <input
            type="number"
            id="extraFees"
            value="2000"
            placeholder="2000"
          />
        </div>
      </div>

      <!-- Step 4: State Selection -->
      <div class="calc-step">
        <h3>Step 4: Select Your State</h3>
        <p>
          Some states (e.g. California, Illinois) have unique fees or franchise taxes. 
          Choose your primary business state for a rough estimate of those additional costs.
        </p>
        <div class="form-group">
          <label class="slider-label" for="stateSelect">Business State:</label>
          <select id="stateSelect">
            <option value="none">-- Select State --</option>
            <option value="ca">California (CA)</option>
            <option value="il">Illinois (IL)</option>
            <option value="other">Other / Not Listed</option>
          </select>
        </div>
      </div>

      <!-- Advanced Toggle Section -->
      <div class="advanced-toggle">
        <label class="toggle-label">
          <input type="checkbox" id="advancedCheck" onclick="toggleAdvancedSection()" /> 
          Show Advanced Settings
        </label>
      </div>
      <div class="advanced-section" id="advancedSection">
        <h4>Advanced Settings</h4>
        <p>
          Customize your calculation further by specifying filing status for 
          Additional Medicare Tax, or toggling advanced disclaimers. 
          This is purely for demonstration.
        </p>

        <!-- Filing status example (for Additional Medicare Tax) -->
        <div class="filing-group">
          <label for="filingStatus">Filing Status (for 0.9% Additional Medicare Tax):</label>
          <select id="filingStatus">
            <option value="single">Single / Head of Household ($200k threshold)</option>
            <option value="married">Married Filing Joint ($250k threshold)</option>
            <option value="none">Ignore Additional Medicare Tax</option>
          </select>
        </div>
      </div>

      <!-- Calculate Button -->
      <div style="text-align:center; margin-top:2rem;">
        <button class="calc-btn" onclick="calculateResults()">Calculate Tax Difference</button>
      </div>

      <!-- 
        RESULTS SECTION 
      -->
      <div class="results-section" id="resultsSection">
        <div class="results-header">
          <h2>Results: S Corp vs. Sole Prop</h2>
          <p>See below for approximate taxes under each structure, plus your potential savings.</p>
        </div>

        <div class="results-grid">
          <!-- Sole Prop Card -->
          <div class="results-card">
            <h3>Sole Proprietorship</h3>
            <p class="result-line" id="sp-seTax"></p>
            <p class="result-line" id="sp-stateTax"></p>
            <p class="result-line result-bold" id="sp-total"></p>
          </div>

          <!-- S Corp Card -->
          <div class="results-card">
            <h3>S Corporation</h3>
            <p class="result-line" id="sc-payrollTax"></p>
            <p class="result-line" id="sc-addMedicare"></p>
            <p class="result-line" id="sc-stateFee"></p>
            <p class="result-line" id="sc-extraCosts"></p>
            <p class="result-line result-bold" id="sc-total"></p>
          </div>
        </div>

        <div class="results-difference" id="resultsDiff"></div>

        <!-- Toggle for Breakdown Table -->
        <div class="breakdown-toggle">
          <label>
            <input type="checkbox" id="breakdownCheck" onclick="toggleBreakdownTable()" />
            Show Detailed Breakdown
          </label>
        </div>
        <div class="breakdown-section" id="breakdownSection">
          <table class="breakdown-table">
            <thead>
              <tr>
                <th>Calculation Step</th>
                <th>Sole Prop Value</th>
                <th>S Corp Value</th>
              </tr>
            </thead>
            <tbody id="breakdownBody">
              <!-- We'll dynamically fill this with JS for each step of the computation. -->
            </tbody>
          </table>
          <p class="breakdown-note">
            Note: This breakdown follows a simplified approach to highlight 
            key differences. Real tax returns often have additional lines 
            and specialized adjustments.
          </p>
        </div>
      </div>
    </div>
  </section>

  <!-- 
    +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
    DISCLAIMER & CTA SECTION
    +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
  -->
  <section class="disclaimer-cta" id="disclaimerCta">
    <h3>Disclaimer</h3>
    <p>
      This calculator is intended for informational purposes only. 
      While it uses recognized methods for computing self-employment tax, 
      Social Security wage base caps, and possible Additional Medicare Tax, 
      it cannot account for every individual scenario or changing tax law. 
      Consult a licensed CPA or tax attorney for personalized advice.
    </p>
    <p>
      CPA On Fire is dedicated to providing accurate and up-to-date 
      information, but final responsibility lies with the user to verify 
      these calculations for official filings.
    </p>
    <h3>Ready to Take Action?</h3>
    <p>
      If you’re considering switching to an S Corp or want a more detailed 
      analysis of your unique tax situation, we’re here to help! 
      Contact us at the link below to schedule a consultation.
    </p>
    <a class="cta-btn" href="mailto:someone@example.com">
      Contact CPA On Fire
    </a>
  </section>

  <!-- 
    +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
    FOOTER
    +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
  -->
  <footer class="footer">
    <div class="container">
      <p>&copy; 2025 CPA On Fire. All Rights Reserved.</p>
    </div>
  </footer>

  <!-- 
    +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
    JAVASCRIPT
    +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
    Below we include a robust script with multiple functions, 
    advanced toggles, official SE tax logic, breakdown table, etc.
  -->
  <script>
    // 
    // 1) CONSTANTS & ADVANCED VARIABLES
    // ---------------------------------
    // 2023 approximate wage base for Social Security:
    const SS_WAGE_BASE_2023 = 160200;
    // Potential 2024 threshold - just for demonstration:
    // const SS_WAGE_BASE_2024 = 168600;

    // Additional Medicare Tax thresholds (0.9%):
    // - Single / HOH: $200k
    // - Married Filing Joint: $250k
    const SINGLE_THRESHOLD = 200000;
    const MARRIED_THRESHOLD = 250000;

    // 
    // 2) HELPER FUNCTIONS
    // ---------------------------------
    function toCurrency(num) {
      // Basic format to 2 decimals with commas:
      return '$' + num.toFixed(2).replace(/\B(?=(\d{3})+(?!\d))/g, ',');
    }

    // Official approach: 
    //  - Net earnings = 92.35% of gross
    //  - Social Security portion (12.4%) up to wage base
    //  - Medicare portion (2.9%) on all net
    //  - Possibly Additional Medicare (0.9%) if thresholds apply
    function calcSelfEmpTax(income, filingStatus) {
      // 1) net earnings
      const netEarnings = income * 0.9235; 

      // 2) SS portion
      let ssTax = 0;
      if (netEarnings <= SS_WAGE_BASE_2023) {
        ssTax = netEarnings * 0.124; 
      } else {
        const baseTax = SS_WAGE_BASE_2023 * 0.124;
        const excess = netEarnings - SS_WAGE_BASE_2023;
        // above wage base, no SS
        ssTax = baseTax; 
      }

      // 3) Medicare portion (2.9%)
      const medicareTax = netEarnings * 0.029;

      // 4) Additional Medicare Tax (0.9%) if advanced toggle is on
      let addlMedTax = 0;
      if (filingStatus !== 'none') {
        // single or married
        const threshold = 
          filingStatus === 'single' 
          ? SINGLE_THRESHOLD 
          : MARRIED_THRESHOLD; // married
        if (netEarnings > threshold) {
          // Only the amount above threshold
          addlMedTax = (netEarnings - threshold) * 0.009; 
          if (addlMedTax < 0) addlMedTax = 0; // safety check
        }
      }
      return {
        netEarnings: netEarnings,
        socialSecurity: ssTax,
        medicare: medicareTax,
        additionalMedicare: addlMedTax,
        total: ssTax + medicareTax + addlMedTax
      };
    }

    // For an S Corp salary:
    // Similar approach to the self-employed logic, but here 
    // we treat the "salary" as the only portion subject to payroll taxes. 
    function calcPayrollTax(salary, filingStatus) {
      // We'll do the same breakdown for demonstration 
      // (12.4% up to wage base, plus 2.9% on all, plus potential 0.9% Additional)
      const netEarnings = salary; // no 92.35% factor for wages
      let ssTax = 0;
      if (netEarnings <= SS_WAGE_BASE_2023) {
        ssTax = netEarnings * 0.124;
      } else {
        const baseTax = SS_WAGE_BASE_2023 * 0.124;
        ssTax = baseTax;
      }
      const medicareTax = netEarnings * 0.029;

      // Additional Medicare if advanced setting is on
      let addlMedTax = 0;
      if (filingStatus !== 'none') {
        const threshold = 
          filingStatus === 'single' 
          ? SINGLE_THRESHOLD 
          : MARRIED_THRESHOLD;
        if (netEarnings > threshold) {
          addlMedTax = (netEarnings - threshold) * 0.009;
          if (addlMedTax < 0) addlMedTax = 0;
        }
      }
      return {
        wage: salary,
        socialSecurity: ssTax,
        medicare: medicareTax,
        additionalMedicare: addlMedTax,
        total: ssTax + medicareTax + addlMedTax
      };
    }

    // 
    // 3) UI HANDLERS: Sliders & Toggles
    // ---------------------------------
    function updateNetIncomeValue(val) {
      document.getElementById('netIncomeValue').textContent = '$' + parseInt(val).toLocaleString();
    }
    function updateOwnerSalaryValue(val) {
      document.getElementById('ownerSalaryValue').textContent = '$' + parseInt(val).toLocaleString();
    }
    function toggleAdvancedSection() {
      const adv = document.getElementById('advancedSection');
      const checked = document.getElementById('advancedCheck').checked;
      adv.style.display = checked ? 'block' : 'none';
    }
    function toggleBreakdownTable() {
      const breakdown = document.getElementById('breakdownSection');
      const checked = document.getElementById('breakdownCheck').checked;
      breakdown.style.display = checked ? 'block' : 'none';
    }

    // 
    // 4) MAIN CALCULATION
    // ---------------------------------
    function calculateResults() {
      // 1) gather input
      const netIncome = parseFloat(document.getElementById('netIncomeRange').value) || 0;
      const ownerSalary = parseFloat(document.getElementById('ownerSalaryRange').value) || 0;
      const extraFees = parseFloat(document.getElementById('extraFees').value) || 0;
      const stateChoice = document.getElementById('stateSelect').value || 'none';

      // advanced
      const advancedOn = document.getElementById('advancedCheck').checked;
      let filingStatus = 'none'; // default no Additional Medicare
      if (advancedOn) {
        filingStatus = document.getElementById('filingStatus').value || 'none';
      }

      // basic validation
      if (ownerSalary > netIncome) {
        alert("Owner salary cannot exceed net income in this scenario.");
        return;
      }

      // 2) compute sole prop taxes
      // Self-employed tax on the entire netIncome
      const spResult = calcSelfEmpTax(netIncome, filingStatus);
      let spStateTaxVal = 0; 
      // If you want to replicate some state SUI for sole prop, we can do so. 
      // For example:
      if (stateChoice === 'ca') {
        // no typical additional self-employed tax for CA 
        // beyond the SE tax, but we could add something for demonstration:
        spStateTaxVal = 0;
      } else if (stateChoice === 'il') {
        spStateTaxVal = 0;
      } 
      // (You can tweak as needed if your state has any special sole prop fees)
      const spTotal = spResult.total + spStateTaxVal;

      // 3) compute S Corp taxes
      // The portion that’s subject to payroll taxes is the ownerSalary
      // The leftover distribution is not subject to SS/Med, but is subject 
      // to normal income tax (which we’re ignoring here for simplicity).
      const scPayroll = calcPayrollTax(ownerSalary, filingStatus);
      
      // Add in extra S Corp fees & possibly state franchise taxes
      let scStateVal = 0; 
      if (stateChoice === 'ca') {
        // CA $800 minimum franchise plus possible extra for SUI 
        scStateVal = 800; 
      } else if (stateChoice === 'il') {
        scStateVal = 175; 
      } 
      // So total S Corp cost is payroll tax + state franchise + extra fees
      const scTotal = scPayroll.total + scStateVal + extraFees;

      // 4) Compare
      const diff = spTotal - scTotal;

      // 5) Update UI
      // Sole Prop results
      document.getElementById('sp-seTax').textContent = 
        "Self-Employment Tax: " + toCurrency(spResult.total);
      if (spStateTaxVal > 0) {
        document.getElementById('sp-stateTax').textContent = 
          "State Additional Tax/Fees: " + toCurrency(spStateTaxVal);
      } else {
        document.getElementById('sp-stateTax').textContent = "";
      }
      document.getElementById('sp-total').textContent = 
        "Total: " + toCurrency(spTotal);

      // S Corp results
      document.getElementById('sc-payrollTax').textContent = 
        "Payroll Taxes: " + toCurrency(scPayroll.total - scPayroll.additionalMedicare);
      if (scPayroll.additionalMedicare > 0) {
        document.getElementById('sc-addMedicare').textContent = 
          "Add'l Medicare Tax: " + toCurrency(scPayroll.additionalMedicare);
      } else {
        document.getElementById('sc-addMedicare').textContent = "";
      }
      if (scStateVal > 0) {
        document.getElementById('sc-stateFee').textContent = 
          "State Franchise Fee: " + toCurrency(scStateVal);
      } else {
        document.getElementById('sc-stateFee').textContent = "";
      }
      document.getElementById('sc-extraCosts').textContent = 
        "S Corp Extra Costs: " + toCurrency(extraFees);
      document.getElementById('sc-total').textContent = 
        "Total: " + toCurrency(scTotal);

      // difference
      const diffElem = document.getElementById('resultsDiff');
      if (diff > 0) {
        diffElem.textContent = "Annual Savings with S Corp: " + toCurrency(diff);
      } else if (diff < 0) {
        diffElem.textContent = "No savings. S Corp is costlier by " + toCurrency(Math.abs(diff));
      } else {
        diffElem.textContent = "No difference in this scenario.";
      }

      // Show results
      const resultsSection = document.getElementById('resultsSection');
      resultsSection.style.display = 'block';
      resultsSection.scrollIntoView({ behavior: 'smooth' });

      // 6) If breakdown is toggled, fill the table
      fillBreakdownTable({
        spResult,
        spStateTaxVal,
        spTotal,
        scPayroll,
        scStateVal,
        extraFees,
        scTotal,
        diff
      });
    }

    // 
    // 5) BREAKDOWN TABLE 
    // ---------------------------------
    // We'll populate step by step in a table if user wants advanced details.
    function fillBreakdownTable(data) {
      const showBreakdown = document.getElementById('breakdownCheck').checked;
      const breakdownTbody = document.getElementById('breakdownBody');
      // Clear existing
      breakdownTbody.innerHTML = "";
      if (!showBreakdown) return;

      // Let's break out each piece for clarity:
      // Sole Prop
      const row1 = makeRow(
        "Net Earnings (92.35% of gross)",
        toCurrency(data.spResult.netEarnings),
        "N/A (S Corp uses wages, no 92.35% factor)"
      );
      breakdownTbody.appendChild(row1);

      const row2 = makeRow(
        "SS Tax (12.4% up to wage base)",
        toCurrency(data.spResult.socialSecurity),
        toCurrency(data.scPayroll.socialSecurity)
      );
      breakdownTbody.appendChild(row2);

      const row3 = makeRow(
        "Medicare (2.9% on all)",
        toCurrency(data.spResult.medicare),
        toCurrency(data.scPayroll.medicare)
      );
      breakdownTbody.appendChild(row3);

      const row4 = makeRow(
        "Additional Medicare (0.9% if applicable)",
        toCurrency(data.spResult.additionalMedicare),
        toCurrency(data.scPayroll.additionalMedicare)
      );
      breakdownTbody.appendChild(row4);

      const row5 = makeRow(
        "State Tax/Franchise Fee",
        data.spStateTaxVal > 0 ? toCurrency(data.spStateTaxVal) : "$0",
        data.scStateVal > 0 ? toCurrency(data.scStateVal) : "$0"
      );
      breakdownTbody.appendChild(row5);

      const row6 = makeRow(
        "Extra S Corp Costs",
        "N/A",
        toCurrency(data.extraFees)
      );
      breakdownTbody.appendChild(row6);

      const row7 = makeRow(
        "Total Self-Empl / Payroll + Fees",
        toCurrency(data.spTotal),
        toCurrency(data.scTotal)
      );
      breakdownTbody.appendChild(row7);

      const row8 = makeRow(
        "Difference (Sole Prop - S Corp)",
        toCurrency(data.diff),
        (data.diff > 0 ? "Savings" : data.diff < 0 ? "More expensive" : "Equal")
      );
      breakdownTbody.appendChild(row8);
    }

    function makeRow(label, spVal, scVal) {
      // Create a new table row 
      const tr = document.createElement('tr');
      const tdLabel = document.createElement('td');
      tdLabel.textContent = label;
      const tdSp = document.createElement('td');
      tdSp.textContent = spVal;
      const tdSc = document.createElement('td');
      tdSc.textContent = scVal;
      tr.appendChild(tdLabel);
      tr.appendChild(tdSp);
      tr.appendChild(tdSc);
      return tr;
    }
  </script>
</body>
</html>
